<div class="list-container">
  @if (tickets().length === 0) {
  <div class="empty-state">
    <mat-icon>inbox</mat-icon>
    <p>No tickets found</p>
  </div>
  } @else {
  <div class="tickets-list">
    @for (ticket of tickets(); track ticket.id) {
    <div
      class="ticket-item"
      [class.active]="selectedId() === ticket.id"
      (click)="select.emit(ticket.id)"
    >
      <div class="ticket-header">
        <span class="ticket-status" [class]="getStatusClass(ticket.status)">
          {{ getStatusLabel(ticket.status) }}
        </span>
        <span class="ticket-date">{{ ticket.createdAt | date : 'MMM d' }}</span>
      </div>

      <h3 class="ticket-subject">{{ ticket.subject }}</h3>

      <!-- New details: Site and Account -->
      <div class="ticket-sub-details">
        @if (ticket.siteNameEn) {
        <span class="detail-item"> <mat-icon>business</mat-icon> {{ ticket.siteNameEn }} </span>
        } @if (ticket.accountNameEn) {
        <span class="detail-item"> <mat-icon>person</mat-icon> {{ ticket.accountNameEn }} </span>
        }
      </div>

      <div class="ticket-meta">
        <span class="priority" [class]="getPriorityClass(ticket.priority)">
          {{ getPriorityLabel(ticket.priority) }}
        </span>
        <span class="sender">{{ ticket.email }}</span>
      </div>
    </div>
    }
  </div>
  }

  <div class="pagination-footer">
    <button
      mat-icon-button
      [disabled]="!hasPreviousPage()"
      (click)="pageChange.emit(currentPage() - 1)"
    >
      <mat-icon>chevron_left</mat-icon>
    </button>
    <span class="page-info">Page {{ currentPage() }}</span>
    <button
      mat-icon-button
      [disabled]="!hasNextPage()"
      (click)="pageChange.emit(currentPage() + 1)"
    >
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>
</div>
